[
  {
    "type": "archive",
    "update": {
      "auth": "#datasetOwner",
      "actions": [
        {
          "actionType": "rabbitmq",
          "server": "myrabbitmq.myinstitution.ext",
          "queue": "archive_updates",
          "templates": {
            "status": "{{job.status}}",
            "message": "{{job.message}}",
            "job": "{{job.id}}",
            "token": "{{secrets.jwt_token}}"
          }
        },
        {
          "actionType": "validate",
          "jobParamsSchema": {
            "$schema": "http://json-schema.org/draft-07/schema#",
            "type": "object",
            "properties": {
              "datasetIds": {
                "type": "array",
                "items": {
                  "type": "string"
                }
              }
            },
            "required": [
              "datasetIds"
            ]
          }
        },
        {
          "actionType": "url",
          "method": "post",
          "url": "http://localhost:6001/test",
          "headers": {
            "AuthBearer": "{{secrets.jwt_token}}"
          },
          "body": "Archiving {{#each jobParams.datasetIds}}{{this}}, {{/each}}"
        }
      ]
    }
  }
]
