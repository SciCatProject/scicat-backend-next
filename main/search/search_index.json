{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"SciCat Backend","text":""},{"location":"#scicat-backend","title":"SciCat Backend","text":""},{"location":"#version-v4x","title":"Version: v4.x","text":""},{"location":"#nestjs-implementation","title":"NestJS implementation","text":""},{"location":"#important","title":"IMPORTANT!!!!","text":"<p>As of 2023/06/15, this repository holds the official version of SciCat backend This is the only version that is officially supported. It is commonly referred to as backend, BE, v4.x or a combination of them.</p> <p>You can find the old backend (v3.x, loopback implementation) at (https://github.com/SciCatProject/backend). The repo for backend v3.x is archived and read-only</p> <p>If you have any questions, please feel free to contact any member of the development team, or the SciCat team at ESS.</p>"},{"location":"#contributing","title":"Contributing","text":"<p>If you're planning to contribute to this project by adding new functionality, we encourage you to discuss it first in the Discussions tab. This helps ensure that your proposed changes align with the project's goals and prevents duplicate efforts. Here's how you can initiate a discussion:</p> <ol> <li>Go to the Discussions tab.</li> <li>Start a new discussion thread outlining your proposed changes.</li> <li>Wait for feedback and consensus before proceeding with creating a pull request.</li> </ol> <p>Thank you for your interest in contributing to our project!</p>"},{"location":"#get-started","title":"Get started","text":"<ol> <li><code>git clone https://github.com/SciCatProject/scicat-backend-next.git</code></li> <li><code>npm install</code></li> <li>Add .env file to project root folder. See Environment variables.</li> <li>Optional Add functionalAccounts.json file to project root folder to create local users.</li> <li>Optional Add loggers.json file to the root folder and configure multiple loggers.</li> <li>Optional Add proposalTypes.json file to the root folder and configure the proposal types.</li> <li><code>npm run start:dev</code></li> <li>Go to http://localhost:3000/explorer to get an overview of available endpoints and database schemas.</li> <li>To be able to run the e2e tests with the same setup as in the Github actions you will need to run <code>npm run  prepare:local</code> and after that run <code>npm run start:dev</code>. This will start all needed containers and copy some configuration to the right place.</li> </ol>"},{"location":"#develop-in-a-container-using-the-docker-composedev-file","title":"Develop in a container using the docker-compose.dev file","text":"<ol> <li><code>git clone https://github.com/SciCatProject/scicat-backend-next.git</code></li> <li>docker-compose -f docker-compose.dev.yaml up -d</li> <li>Optional Mount functionalAccounts.json file to a volume in the container to create local users.</li> <li>Optional Mount loggers.json file to a volume in the container to configure multiple loggers.</li> <li>Optional Mount proposalTypes.json file to a volume in the container to configure the proposal types.</li> <li>Optional change the container env variables</li> <li>Attach to the container</li> <li><code>npm run start:dev</code></li> <li>Go to http://localhost:3000/explorer to get an overview of available endpoints and database schemas.</li> </ol>"},{"location":"#test-the-app","title":"Test the app","text":"<ol> <li>Running the unit tests: <code>npm run test</code></li> <li> <p>Running the e2e(api) tests:</p> </li> <li> <p>First of all run <code>npm run prepare:local</code> to prepare the local environment for starting</p> </li> <li>After that run <code>npm run test:api</code> which will start the backend locally and run both <code>jest</code> and <code>mocha</code> e2e(api) tests.</li> <li>[Optional] If you want to run only the mocha tests you will need to start the backend locally with <code>npm run start</code> and then use <code>npm run test:api:mocha</code></li> <li>[Optional] If you want to run only the jest tests you can use <code>npm run test:api:jest</code></li> </ol>"},{"location":"#configuration","title":"Configuration","text":"<p>There are multiple ways to configure your SciCat instance.</p> <p>In order to configure a SciCat instance run on barebone OS, there are three options:</p> <ol> <li>Edit directly the file <code>src/config/configuration.ts</code></li> <li>Create a <code>.env</code> file with your local value of the variables listed in the next session. Only the variables that are required by your installation should be defined. To create your <code>.env</code> file, you can copy and edit the sample <code>.env.example</code> provided with in code</li> <li>Define in your environment all the necessary variables (list provided below), prior running SciCat.</li> </ol> <p>If SciCat runs in a containeraized environment, like docker or kubernetes, you can run the release image and specify your configuration using one of the following two methods:</p> <ol> <li>create <code>.env</code> and mount it directly in your container.</li> <li>define the necessary environment variables directly in your container.</li> </ol> <p>More information are provided in the official documentation.</p>"},{"location":"#local-user-accounts","title":"Local User Accounts","text":"<p>Providing a file called functionalAccounts.json at the root of the project, locally or in the container, will automatically create the specified accounts on startup. If this file is not provided, no local users will be created.</p> <p>Follow the structure of functionalAccounts.json.minimal.example to create your own functionalAccounts.json file.</p>"},{"location":"#loggers-configuration","title":"Loggers configuration","text":"<p>Providing a file called loggers.json at the root of the project, locally or in the container, and create an external logger class in the <code>src/loggers/loggingProviders/</code>directory will automatically create specified one or multiple loggers instances.</p> <p>The <code>loggers.json.example</code> file in the root directory showcases the example of configuration structure for the one or multiple loggers. <code>logger.service.ts</code> file contains the configuration handling process logic, and <code>src/loggers/loggingProviders/grayLogger.ts</code> includes actual usecase of grayLogger.</p>"},{"location":"#prpopsal-types-configuration","title":"Prpopsal types configuration","text":"<p>Providing a file called proposalTypes.json at the root of the project, locally or in the container, will be automatically loaded into the application configuration service under property called <code>proposalTypes</code> and used for validation against proposal creation and update.</p> <p>The <code>proposalTypes.json.example</code> file in the root directory showcases the example of configuration structure for proposal types.</p>"},{"location":"#environment-variables","title":"Environment variables","text":"<p>Valid environment variables for the .env file. See .env.example for examples value formats. | Environment Variable | Type | Optional | Description | Default Value | |---------------------------------------------|---------|----------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------| | <code>ADMIN_GROUPS</code> | string | Yes | Comma-separated list of admin groups with admin permission assigned to the listed users. Example: \"admin, ingestor\". For more details check: Scicat Documentation | | | <code>CREATE_DATASET_GROUPS</code> | string | Yes | Comma-separated list of create dataset groups. Users belong to the listed groups can create dataset with/without PID. Example: \"group1, group2\". For more details check: Scicat Documentation | | | <code>CREATE_DATASET_WITH_PID_GROUPS</code> | string | Yes | Comma-separated list of create dataset with pid groups. Users belong to the listed groups can create dataset with PID. Example: \"group1, group2\". For more details check: Scicat Documentation | | | <code>DELETE_GROUPS</code> | string | Yes | Comma-separated list of delete groups. Users belong to the listed groups can delete any dataset, origDatablocks, datablocks, etc. For more details check: Scicat Documentation | | | <code>DATASET_CREATION_VALIDATION_ENABLED</code> | boolean | | Flag to enable/disable dataset validation to validate if requested new dataset is valid with given regular expression. Preconfigure DATASET_CREATION_VALIDATION_REGEX variable is required. | false | | <code>DATASET_CREATION_VALIDATION_REGEX</code> | string | | Regular expression validation for new dataset request. | \"\" | | <code>PROPOSAL_GROUPS</code> | string | Yes | Comma-separated list of proposal groups with permission to create any proposals. Example: \"proposaladmin, proposalingestor\". For more details check: Scicat Documentation | | | <code>SAMPLE_GROUPS</code> | string | Yes | Comma-separated list of sample groups with permission to create any samples. Example: \"sampleadmin, sampleingestor\". For more details check: Scicat Documentation | | | <code>ACCESS_GROUPS_GRAPHQL_ENABLED</code> | string | Yes | Flag to enable/disable the GraphQL service to get access groups. Requires configuration of <code>ACCESS_GROUP_SERVICE_TOKEN</code>, <code>ACCESS_GROUP_SERVICE_API_URL</code>, and <code>ACCESS_GROUP_SERVICE_HANDLER</code>. | true | | <code>ACCESS_GROUPS_SERVICE_TOKEN</code> | string | Yes | Authentication token used if access groups are obtained from a third-party service. Not used by the vanilla installation, but only if the instance is customized to use an external service to provide user groups, like the ESS example. | | | <code>ACCESS_GROUP_SERVICE_API_URL</code> | string | Yes | URL of the service providing the users' access groups. Not used by the vanilla installation, but only if the instance is customized to use an external service to provide user groups, like the ESS example. | | | <code>ACCESS_GROUP_SERVICE_HANDLER</code> | string | Yes | Configuration property that points to the source of a module. This module provides a specific responseProcessor function for handling GraphQL responses and a query template for making GraphQL requests. | | | <code>ACCESS_GROUPS_STATIC_ENABLED</code> | string | Yes | Flag to enable/disable automatic assignment of predefined access groups to all users. | true | | <code>ACCESS_GROUPS_STATIC_VALUES</code> | string | Yes | Comma-separated list of access groups automatically assigned to all users. Example: \"scicat, user\". | | | <code>ACCESS_GROUPS_OIDCPAYLOAD_ENABLED</code> | string | Yes | Flag to enable/disable fetching access groups directly from OIDC response. Requires specifying a field via <code>OIDC_ACCESS_GROUPS_PROPERTY</code> to extract access groups. | false | | <code>DOI_PREFIX</code> | string | | The facility DOI prefix, with trailing slash. | | | <code>EXPRESS_SESSION_SECRET</code> | string | No | Secret used to set up express session. Required if using OIDC authentication | | | <code>HTTP_MAX_REDIRECTS</code> | number | Yes | Max redirects for HTTP requests. | 5 | | <code>HTTP_TIMEOUT</code> | number | Yes | Timeout for HTTP requests in ms. | 5000 | | <code>JWT_SECRET</code> | string | | The secret for your JWT token, used for authorization. | | | <code>JWT_EXPIRES_IN</code> | number | Yes | How long, in seconds, the JWT token is valid. | 3600 | | <code>LDAP_URL</code> | string | Yes | The URL to your LDAP server. | | | <code>LDAP_BIND_DN</code> | string | Yes | Bind_DN for your LDAP server. | | | <code>LDAP_BIND_CREDENTIALS</code> | string | Yes | Credentials for your LDAP server. | | | <code>LDAP_SEARCH_BASE</code> | string | Yes | Search base for your LDAP server. | | | <code>LDAP_SEARCH_FILTER</code> | string | Yes | Search filter for your LDAP server. | | | <code>OIDC_ISSUER</code> | string | Yes | URL of the OIDC server providing the authentication service. Example: https://identity.esss.dk/realm/ess. | | | <code>OIDC_CLIENT_ID</code> | string | Yes | Identity of the client used to obtain the user token. Example: scicat. | | | <code>OIDC_CLIENT_SECRET</code> | string | Yes | Secret to provide to the OIDC service to obtain the user token. Example: Aa1JIw3kv3mQlGFWhRrE3gOdkH6xreAwro. | | | <code>OIDC_CALLBACK_URL</code> | string | Yes | SciCat callback URL to redirect to after a successful login. Example: http://myscicat/api/v3/oidc/callback. | | | <code>OIDC_SCOPE</code> | string | Yes | Space-separated list of info returned by the OIDC service. Example: \"openid profile email\". | | | <code>OIDC_SUCCESS_URL</code> | string | Yes | SciCat Frontend auth-callback URL. Required to pass user credentials to SciCat Frontend after OIDC login. Example: https://myscicatfrontend/auth-callback. Must be <code>frontend-base-url/auth-callback</code> or <code>frontend-base-url/login</code> for the official SciCat frontend. | | | <code>OIDC_RETURN_URL</code> | string | Yes | The path segment within the SciCat Frontend to redirect to, passed as query param in <code>OIDC_SUCCESS_URL</code> and handled by frontend. Example: /datasets. | | | <code>OIDC_FRONTEND_CLIENTS</code> | string | Yes | Comma separated list of additional frontend OIDC clients for this backend. Example: scilog,maxiv. Their success and return URLs can be configured by setting <code>OIDC_${CLIENT}_SUCCESS_URL</code> (E.g. <code>OIDC_SCILOG_SUCCESS_URL</code>) and <code>OIDC_${CLIENT}_RETURN_URL</code> | | | <code>OIDC_ACCESS_GROUPS</code> | string | Yes | Functionality is still unclear. | | | <code>OIDC_ACCESS_GROUPS_PROPERTY</code> | string | Yes | Target field to get the access groups value from OIDC response. | | | <code>OIDC_USERINFO_MAPPING_FIELD_USERNAME</code> | string | Yes | Comma-separated list of fields from the OIDC response to use as the user's profile username. Example: <code>OIDC_USERINFO_MAPPING_FIELD_USERNAME=\"iss, sub\"</code>. | \"preferred_username\" || \"name\" | | <code>OIDC_USERINFO_MAPPING_FIELD_DISPLAYNAME</code> | string | Yes | Field from the OIDC response to use as the user's profile display name. Example: <code>OIDC_USERINFO_MAPPING_FIELD_DISPLAYNAME=\"preferred_username\"</code>. | \"name\" | | <code>OIDC_USERINFO_MAPPING_FIELD_EMAIL</code> | string | Yes | Field from the OIDC response to use as the user's profile email. | \"email\" | | <code>OIDC_USERINFO_MAPPING_FIELD_FAMILYNAME</code> | string | Yes | Field from the OIDC response to use as the user's profile family name. | \"family_name\" | | <code>OIDC_USERINFO_MAPPING_FIELD_ID</code> | string | Yes | Field from the OIDC response to use as the user's profile ID. | \"sub\" || \"user_id\" | | <code>OIDC_USERINFO_MAPPING_FIELD_THUMBNAILPHOTO</code>| string | Yes | Field from the OIDC response to use as the user's profile thumbnail photo. | \"thumbnailPhoto\" | | <code>OIDC_USERINFO_MAPPING_FIELD_PROVIDER</code> | string | Yes | Field from the OIDC response to use as the user's profile provider. | \"iss\" | | <code>OIDC_USERINFO_MAPPING_FIELD_GROUP</code> | string | Yes | Field from the OIDC response to use as the user's profile group. | \"groups\" | | <code>OIDC_USERQUERY_OPERATOR</code> | string | Yes | Specifies the operator (\"or\" or \"and\") for UserModel.findOne queries, determining the logic used to match fields like \"username\" or \"email\". Example: <code>UserModel.findOne({$or: {\"username\":\"testUser\", \"email\":\"test@test.com\"}})</code>. | \"or\" | | <code>OIDC_USERQUERY_FILTER</code> | string | Yes | Defines key-value pairs for UserModel.findOne queries, using a \"key:value\" format. Example: <code>OIDC_USERQUERY_FILTER=\"username:sub, email:email\"</code>. | \"username:username, email:email\" | | <code>LOGBOOK_ENABLED</code> | string | Yes | Flag to enable/disable the Logbook endpoints. Values \"yes\" or \"no\". | \"no\" | | <code>LOGBOOK_BASE_URL</code> | string | Yes | The base URL to the Logbook API. Only required if Logbook is enabled. | | | <code>METADATA_KEYS_RETURN_LIMIT</code> | number | Yes | The return limit for the <code>/Datasets/metadataKeys</code> endpoint. | | | <code>METADATA_PARENT_INSTANCES_RETURN_LIMIT</code> | number | Yes | The return limit of Datasets to extract metadata keys from for the <code>/Datasets/metadataKeys</code> endpoint. | | | <code>MONGODB_URI</code> | string | | The URI for your MongoDB instance. | | | <code>OAI_PROVIDER_ROUTE</code> | string | Yes | URI to OAI provider, used for the <code>/publisheddata/:id/resync</code> endpoint. | | | <code>PID_PREFIX</code> | string | | The facility PID prefix, with trailing slash. | | | <code>PUBLIC_URL_PREFIX</code> | string | | The base URL to the facility Landing Page. | | | <code>PORT</code> | number | Yes | The port on which you want to access the app. | 3000 | | <code>RABBITMQ_ENABLED</code> | string | Yes | Flag to enable/disable RabbitMQ consumer. Values \"yes\" or \"no\". | \"no\" | | <code>RABBITMQ_HOSTNAME</code> | string | Yes | The hostname of the RabbitMQ message broker. Only required if RabbitMQ is enabled. | | | <code>RABBITMQ_USERNAME</code> | string | Yes | The username used to authenticate to the RabbitMQ message broker. Only required if RabbitMQ is enabled. | | | <code>RABBITMQ_PASSWORD</code> | string | Yes | The password used to authenticate to the RabbitMQ message broker. Only required if RabbitMQ is enabled. | | | <code>REGISTER_DOI_URI</code> | string | | URI to the organization that registers the facility's DOIs. | | | <code>REGISTER_METADATA_URI</code> | string | | URI to the organization that registers the facility's published data metadata. | | | <code>SITE</code> | string | | The name of your site. | | | <code>EMAIL_TYPE</code> | string | Yes | The type of your email provider. Options are \"smtp\" or \"ms365\".  | \"smtp\" | | <code>EMAIL_FROM</code> | string | Yes | Email address that emails should be sent from. | | | <code>EMAIL_REPLYTO</code> | string | Yes | Email 'Reply-To' field. | | | <code>SMTP_HOST</code> | string | Yes | Host of SMTP server. | | | <code>SMTP_MESSAGE_FROM</code> | string | Yes | (Deprecated) Alternate spelling of EMAIL_FROM.| | | <code>SMTP_PORT</code> | number | Yes | Port of SMTP server. | 587 | | <code>SMTP_SECURE</code> | bool | Yes | Use encrypted SMTPS. | \"no\" | | <code>MS365_TENANT_ID</code> | string | Yes | Tenant ID for sending emails over Microsoft Graph API. | | | <code>MS365_CLIENT_ID</code> | string | Yes | Client ID for sending emails over Microsoft Graph API | | | <code>MS365_CLIENT_SECRET</code> | string | Yes | Client Secret for sending emails over Microsoft Graph API | | | <code>POLICY_PUBLICATION_SHIFT</code> | integer | Yes | Embargo period expressed in years. | 3 years | | <code>POLICY_RETENTION_SHIFT</code> | integer | Yes | Retention period (how long the facility will hold on to data) expressed in years. | -1 (indefinitely) | | <code>ELASTICSEARCH_ENABLED</code> | string | | Flag to enable/disable the Elasticsearch endpoints. Values \"yes\" or \"no\". | \"no\" | | <code>ES_HOST</code> | string | | Host of Elasticsearch server instance. | | | <code>ES_USERNAME</code> | string | Yes | Elasticsearch username. | \"elastic\" | | <code>ES_PASSWORD</code> | string | | Elasticsearch password. | | | <code>MONGODB_COLLECTION</code> | string | | Collection name to be mapped into specified Elasticsearch index. Used for data synchronization between MongoDB and Elasticsearch index. | | | <code>ES_MAX_RESULT</code> | number | | Maximum records that can be indexed into Elasticsearch. | 10000 | | <code>ES_FIELDS_LIMIT</code> | number | | The total number of fields in an index. | 1000 | | <code>ES_REFRESH</code> | string | | If set to <code>wait_for</code>, Elasticsearch will wait till data is inserted into the specified index before returning a response. | false | | <code>LOGGERS_CONFIG_FILE</code> | string | | The file name for loggers configuration, located in the project root directory. | \"loggers.json\" | | <code>PROPOSAL_TYPES_FILE</code> | string | | The file name for proposal types configuration, located in the project root directory. | \"proposalTypes.json\" | | <code>SWAGGER_PATH</code> | string | Yes | swaggerPath is the path where the swagger UI will be available. | \"explorer\"| | <code>MAX_FILE_UPLOAD_SIZE</code> | string | Yes | Maximum allowed file upload size. | \"16mb\"|</p>"},{"location":"#migrating-from-the-old-scicat-backend","title":"Migrating from the old SciCat Backend","text":"<p>Where the current SciCat Backend accepts id fields in the database named <code>pid</code>, <code>doi</code>, or similar, this implementation requires there to be an id field of the form <code>_id</code> on every document. It is therefore necessary to run a database migration script towards MongoDB instance from a place where you have access to it and can install <code>migrate-mongo</code> package.</p> <p>All database migration scripts located in the migrations folder. To start the migration use:</p> <pre><code>npm run migrate:db:up\n</code></pre> <p>For down migration use:</p> <pre><code>npm run migrate:db:down\n</code></pre> <p>For listing applied DB migrations:</p> <pre><code>npm run migrate:db:status\n</code></pre> <p>For the full documentation please go to the SciCat home page and follow the documentation link</p>"},{"location":"#migration-documentation-and-nestjs-resources","title":"Migration documentation and NestJs resources","text":"<p>Following are the post that I found useful working on the migration:</p> <ul> <li>Schema and DTOs: https://betterprogramming.pub/how-to-use-data-transfer-objects-dto-for-validation-in-nest-js-7ff95309f650</li> <li>Validation:</li> <li>Official documentation</li> <li>Custom validation with datasbase in NestJs</li> <li>Validating nested objects with class-validator in NestJs</li> <li>Validating numeric query parameters in NestJS</li> <li>Injecting request object to a custom validation class in NestJS</li> <li>Swagger and OpenAPI:</li> <li>https://docs.nestjs.com/openapi/introduction</li> <li>https://docs.nestjs.com/openapi/types-and-parameters</li> <li>https://docs.nestjs.com/openapi/decorators</li> </ul>"},{"location":"#license","title":"License","text":"<p>This project is licensed under the GPL License - see the LICENSE file for details</p>"},{"location":"#acknowledgments","title":"Acknowledgments","text":"<p>Scicat is developed at PSI, ESS and MAXIV with in-kind funding from ESS and from the European Union Framework Programme for Research and Innovation Horizon 2020, under grant agreement 676548, \u201cBrightnESS\u201d.</p>"},{"location":"about/","title":"About SciCat","text":""},{"location":"about/#about-scicat","title":"About SciCat","text":"<p>SciCat is a community driven scientific metadata catalog designed to simplify metadata management, enabling data sharing, discovery, and collaboration. By providing a central hub for metadata, SciCat makes data easily findable and accessible for the entire community. With flexible integration into diverse infrastructures and a clear path to data publication, SciCat empowers organizations to foster an open and innovative data culture, driving high-quality science forward.</p> <p>For more information about the SciCat Project please visit https://scicatproject.org</p>"},{"location":"developer-guide/HISTORY/","title":"Developer guide","text":""},{"location":"developer-guide/HISTORY/#history-implementation-guide-for-scicat-backend","title":"History Implementation Guide for SciCat Backend","text":"<p>This guide provides developers with comprehensive instructions for implementing history tracking in new entities/modules within the SciCat backend.</p>"},{"location":"developer-guide/HISTORY/#overview","title":"Overview","text":"<p>The SciCat backend includes a centralized history system that tracks changes to critical data entities. Currently implemented for:</p> <ul> <li>Dataset</li> <li>Proposal</li> <li>Sample</li> <li>Instrument</li> <li>PublishedData</li> <li>Policy</li> <li>Datablock</li> <li>Attachment</li> </ul>"},{"location":"developer-guide/HISTORY/#architecture","title":"Architecture","text":"<p>The history system consists of:</p> <ol> <li>Generic History Schema (<code>src/common/schemas/generic-history.schema.ts</code>)</li> <li>History Plugin (<code>src/common/mongoose/plugins/history.plugin.ts</code>)</li> <li>History Service (<code>src/history/history.service.ts</code>)</li> <li>History Controller (<code>src/history/history.controller.ts</code>)</li> <li>CASL Authorization for history access control</li> </ol>"},{"location":"developer-guide/HISTORY/#authorization-model","title":"Authorization Model","text":"<p>The history module implements a two-layer authorization model consistent with the rest of the application:</p>"},{"location":"developer-guide/HISTORY/#1-endpoint-level-access","title":"1. Endpoint-Level Access","text":"<p>Controlled by <code>historyEndpointAccess()</code> in the CASL factory, this determines if a user has permission to use the history API endpoints at all. This is checked using:</p> <pre><code>@CheckPolicies(\"history\", (ability: AppAbility) =&gt;\n  ability.can(Action.HistoryReadEndpoint, \"GenericHistory\"),\n)\n</code></pre>"},{"location":"developer-guide/HISTORY/#2-instance-level-access","title":"2. Instance-Level Access","text":"<p>Controlled by <code>historyInstanceAccess()</code> in the CASL factory, this determines if a user has permission to access specific subsystem histories (Dataset, Proposal, etc.). This is checked for each specific history request:</p> <pre><code>// Example from controller\nconst ability = this.caslFactory.historyInstanceAccess(request.user as JWTUser);\nconst requiredAction = this.subsystemActionMap[subsystem];\nif (!requiredAction || !ability.can(requiredAction, \"GenericHistory\")) {\n  throw new ForbiddenException(`No access to ${subsystem} history`);\n}\n</code></pre> <p>Each subsystem has its own specific action permission (e.g., <code>Action.HistoryReadDataset</code>, <code>Action.HistoryReadProposal</code>).</p>"},{"location":"developer-guide/HISTORY/#step-by-step-implementation-guide","title":"Step-by-Step Implementation Guide","text":""},{"location":"developer-guide/HISTORY/#1-module-configuration","title":"1. Module Configuration","text":"<p>To add history tracking to a new entity, modify your module's <code>MongooseModule.forFeatureAsync</code> configuration:</p> <pre><code>import { historyPlugin } from \"../common/mongoose/plugins/history.plugin\";\nimport {\n  GenericHistory,\n  GenericHistorySchema,\n} from \"../common/schemas/generic-history.schema\";\nimport { getCurrentUsername } from \"../common/utils/request-context.util\";\n\n@Module({\n  imports: [\n    CaslModule,\n    ConfigModule,\n    // Import the GenericHistory schema\n    MongooseModule.forFeature([\n      {\n        name: GenericHistory.name,\n        schema: GenericHistorySchema,\n      },\n    ]),\n    // Configure your entity with history plugin\n    MongooseModule.forFeatureAsync([\n      {\n        name: YourEntity.name,\n        imports: [ConfigModule],\n        inject: [ConfigService],\n        useFactory: (configService: ConfigService) =&gt; {\n          const schema = YourEntitySchema;\n\n          // existing code...\n\n          // Apply history plugin once if schema name matches TRACKABLES config\n          // Pass both schema and configService to applyHistoryPluginOnce\n          applyHistoryPluginOnce(schema, configService);\n\n          return schema;\n        },\n      },\n    ]),\n  ],\n  controllers: [YourEntityController],\n  providers: [YourEntityService],\n  exports: [YourEntityService],\n})\nexport class YourEntityModule {}\n</code></pre>"},{"location":"developer-guide/HISTORY/#2-configuration-setup","title":"2. Configuration Setup","text":""},{"location":"developer-guide/HISTORY/#environment-variables","title":"Environment Variables","text":"<p>Add your entity to the <code>TRACKABLES</code> environment variable in <code>.env</code>:</p> <pre><code>TRACKABLES=Dataset,Proposal,Sample,Instrument,PublishedData,Policy,Datablock,Attachment,YourEntity\n</code></pre>"},{"location":"developer-guide/HISTORY/#configuration-file","title":"Configuration File","text":"<p>Add history access groups to <code>src/config/configuration.ts</code>:</p> <pre><code>// Add environment variable extraction\nconst historyYourEntityGroups = process.env.HISTORY_ACCESS_YOUR_ENTITY_GROUPS || \"\";\n\n// Add to accessGroups section\naccessGroups: {\n  // ... existing groups\n\n  //History\n  historyYourEntity: historyYourEntityGroups\n    ? historyYourEntityGroups.split(\",\").map((v) =&gt; v.trim())\n    : [],\n}\n</code></pre>"},{"location":"developer-guide/HISTORY/#environment-variable-definition","title":"Environment Variable Definition","text":"<p>Add to your environment configuration:</p> <pre><code>HISTORY_ACCESS_YOUR_ENTITY_GROUPS=yourEntityHistoryGroup,anotherGroup\n</code></pre>"},{"location":"developer-guide/HISTORY/#3-casl-authorization-configuration","title":"3. CASL Authorization Configuration","text":"<p>Update <code>src/casl/action.enum.ts</code> to add a new action for your entity:</p> <pre><code>export enum Action {\n  // ... existing actions\n\n  // History actions\n  HistoryReadEndpoint = \"history_read_endpoint\",\n  // ... existing history read actions\n  HistoryReadYourEntity = \"history_read_yourentity\",\n}\n</code></pre> <p>Update both authorization functions in <code>src/casl/casl-ability.factory.ts</code>:</p> <pre><code>// 1. Update endpoint-level access\nhistoryEndpointAccess(user: JWTUser) {\n  const { can, build } = new AbilityBuilder(\n    createMongoAbility&lt;PossibleAbilities, Conditions&gt;,\n  );\n\n  if (user) {\n    if (user.currentGroups &amp;&amp; Array.isArray(user.currentGroups)) {\n      // ... existing code\n\n      // Users with access to your entity history also get endpoint access\n      if (\n        user.currentGroups.some((g) =&gt;\n          this.accessGroups?.historyYourEntity.includes(g),\n        )\n      ) {\n        can(Action.HistoryReadEndpoint, \"GenericHistory\");\n      }\n    }\n  }\n\n  return build({\n    detectSubjectType: (item) =&gt;\n      item.constructor as ExtractSubjectType&lt;Subjects&gt;,\n  });\n}\n\n// 2. Update instance-level access\nhistoryInstanceAccess(user: JWTUser) {\n  const { can, build } = new AbilityBuilder(\n    createMongoAbility&lt;PossibleAbilities, Conditions&gt;,\n  );\n\n  if (user &amp;&amp; user.currentGroups &amp;&amp; Array.isArray(user.currentGroups)) {\n    if (\n      user.currentGroups.some((g) =&gt;\n        this.accessGroups?.admin.includes(g),\n      )\n    ) {\n      // Admin gets access to all subsystems\n      can(Action.HistoryReadYourEntity, \"GenericHistory\");\n      // ... other existing permissions\n    } else {\n      // Specific permissions for your entity\n      if (\n        user.currentGroups.some((g) =&gt;\n          this.accessGroups?.historyYourEntity.includes(g),\n        )\n      ) {\n        can(Action.HistoryReadYourEntity, \"GenericHistory\");\n      }\n    }\n  }\n\n  return build({\n    detectSubjectType: (item) =&gt;\n      item.constructor as ExtractSubjectType&lt;Subjects&gt;,\n  });\n}\n</code></pre>"},{"location":"developer-guide/HISTORY/#4-update-the-history-controller","title":"4. Update the History Controller","text":"<p>Update the subsystem action map in the history controller:</p> <pre><code>private readonly subsystemActionMap = {\n  // ... existing mappings\n  YourEntity: Action.HistoryReadYourEntity,\n};\n</code></pre>"},{"location":"developer-guide/HISTORY/#5-service-implementation","title":"5. Service Implementation","text":"<p>Your service methods should properly handle metadata fields when performing updates:</p> <pre><code>import { HistoryService } from \"../history/history.service\";\nimport { getCurrentUsername } from \"../common/utils/request-context.util\";\n\n@Injectable()\nexport class YourEntityService {\n  constructor(\n    @InjectModel(YourEntity.name)\n    private yourEntityModel: Model&lt;YourEntityDocument&gt;,\n    private historyService: HistoryService, // Inject if needed for custom queries\n  ) {}\n\n  // The history plugin automatically handles tracking of create, update, delete operations\n  // But you need to properly set updatedBy and updatedAt in your update methods:\n\n  async update(id: string, updateDto: UpdateYourEntityDto) {\n    const username = getCurrentUsername();\n\n    return this.yourEntityModel.findByIdAndUpdate(\n      id,\n      {\n        $set: {\n          ...updateDto,\n          updatedBy: username,\n          updatedAt: new Date(),\n        },\n      },\n      { new: true, runValidators: true },\n    );\n  }\n}\n</code></pre>"},{"location":"developer-guide/HISTORY/#history-plugin-options","title":"History Plugin Options","text":"<p>The history plugin accepts several configuration options:</p> <pre><code>interface HistoryPluginOptions {\n  historyModelName?: string; // Default: GenericHistory.name\n  modelName?: string; // Required: Must match TRACKABLES\n  getActiveUser?: () =&gt; string; // Function to get current user\n  configService?: ConfigService; // For accessing environment variables\n  trackableStrategy?: \"delta\" | \"document\"; // Default: \"document\"\n  trackables?: string[]; // Override TRACKABLES config\n}\n</code></pre>"},{"location":"developer-guide/HISTORY/#tracking-strategies","title":"Tracking Strategies","text":"<ol> <li>Document Strategy (default): Stores complete before/after document states</li> <li>Delta Strategy: Stores only changed fields with their before/after values</li> </ol> <p>Configure via environment variable:</p> <pre><code>TRACKABLE_STRATEGY=delta  # or \"document\"\n</code></pre>"},{"location":"developer-guide/HISTORY/#history-data-structure","title":"History Data Structure","text":"<p>Each history record contains:</p> <pre><code>{\n  subsystem: string;        // Entity name (e.g., \"YourEntity\")\n  documentId: string;       // The _id of the changed document\n  before?: object;          // Document state before change\n  after?: object;           // Document state after change (null for deletes)\n  operation: \"update\" | \"delete\";\n  timestamp: Date;          // Auto-generated\n  user?: string;           // Username who made the change\n}\n</code></pre>"},{"location":"developer-guide/HISTORY/#testing","title":"Testing","text":""},{"location":"developer-guide/HISTORY/#unit-tests","title":"Unit Tests","text":"<p>Test your history implementation:</p> <pre><code>describe(\"YourEntity History\", () =&gt; {\n  it(\"should record history on update\", async () =&gt; {\n    const entity = await yourEntityService.create(testData);\n\n    await yourEntityService.update(entity._id, { field: \"newValue\" });\n\n    const history = await historyService.find({\n      subsystem: \"YourEntity\",\n      documentId: entity._id,\n    });\n\n    expect(history).toHaveLength(1);\n    expect(history[0].operation).toBe(\"update\");\n    expect(history[0].before.field).toBe(\"oldValue\");\n    expect(history[0].after.field).toBe(\"newValue\");\n  });\n});\n</code></pre>"},{"location":"developer-guide/HISTORY/#integration-tests","title":"Integration Tests","text":"<p>Add tests similar to existing ones in <code>/test/</code> directory:</p> <pre><code>describe(\"YourEntity History API\", () =&gt; {\n  it(\"should get history for entity\", async () =&gt; {\n    return request(appUrl)\n      .get(\"/api/v3/history\")\n      .query({\n        filter: JSON.stringify({\n          subsystem: \"YourEntity\",\n          documentId: entityId,\n        }),\n      })\n      .set(\"Authorization\", `Bearer ${accessToken}`)\n      .expect(200)\n      .then((res) =&gt; {\n        res.body.should.have.property(\"items\");\n        res.body.items.should.be.an(\"array\");\n      });\n  });\n});\n</code></pre>"},{"location":"developer-guide/HISTORY/#best-practices","title":"Best Practices","text":"<ol> <li>Model Name Consistency: Ensure the <code>modelName</code> in the plugin matches the name in <code>TRACKABLES</code></li> <li>Access Control: Always implement proper CASL authorization for history access</li> <li>Testing: Include both unit and integration tests for history functionality</li> <li>Performance: Consider the volume of changes when choosing tracking strategy</li> <li>Documentation: Update API documentation to include history endpoints</li> </ol>"},{"location":"developer-guide/HISTORY/#troubleshooting","title":"Troubleshooting","text":""},{"location":"developer-guide/HISTORY/#common-issues","title":"Common Issues","text":"<ol> <li>History not recording: Check that entity name is in <code>TRACKABLES</code> environment variable</li> <li>Permission denied: Verify CASL configuration includes your entity</li> <li>Plugin not loading: Ensure <code>ConfigService</code> is properly injected</li> <li>Missing user info: Verify <code>getCurrentUsername()</code> is working correctly</li> </ol>"},{"location":"developer-guide/HISTORY/#debug-logging","title":"Debug Logging","text":"<p>Enable debug logging to troubleshoot:</p> <pre><code>// The plugin logs when history tracking is enabled\nconsole.log(`History tracking enabled for model: ${modelName}`);\n</code></pre>"},{"location":"developer-guide/HISTORY/#migration-notes","title":"Migration Notes","text":"<p>When adding history to existing entities:</p> <ol> <li>Existing records won't have history until first modification</li> <li>Consider backfilling critical historical data if needed</li> <li>Test thoroughly with existing data before deployment</li> </ol>"},{"location":"developer-guide/HISTORY/#related-files","title":"Related Files","text":"<ul> <li><code>/src/common/schemas/generic-history.schema.ts</code> - History data model</li> <li><code>/src/common/mongoose/plugins/history.plugin.ts</code> - Core plugin implementation</li> <li><code>/src/history/</code> - History service and controller</li> <li><code>/src/casl/casl-ability.factory.ts</code> - Authorization configuration</li> <li><code>/test/Datablock.js</code> - Example of history testing</li> </ul> <p>This guide should provide everything needed to implement history tracking for new entities in the SciCat backend system.</p>"},{"location":"developer-guide/release-guidelines/","title":"New Release Version Bump Workflow","text":""},{"location":"developer-guide/release-guidelines/#new-release-version-bump-workflow","title":"New Release Version Bump Workflow","text":""},{"location":"developer-guide/release-guidelines/#workflow-overview","title":"Workflow Overview","text":"<p>Scicat Backend controls new releases with the <code>GitHub-tag-and-release</code> GitHub Action. This workflow is triggered by push events to the release branch. It automates the version bumping and release processes based on semantic commit messages. Full documentation of the action package can be found on github-tag-action</p> <p>The image below shows visualized workflow. </p>"},{"location":"developer-guide/release-guidelines/#workflow-trigger-condition","title":"Workflow Trigger Condition","text":"<p>[!Caution] Any push to the <code>release</code> branch initiates the workflow.</p>"},{"location":"developer-guide/release-guidelines/#versioning-and-release-strategy","title":"Versioning and Release Strategy","text":"<p>Semantic Versioning:</p> <ul> <li> <p>The version is automatically bumped according to the semantic PR titles, using the semantic-release conventions:</p> </li> <li> <p><code>fix:</code> prefixed titles generate a patch release.</p> </li> <li><code>feat:</code> prefixed titles generate a minor release.</li> <li><code>BREAKING CHANGE:</code> in the commit message triggers a major release.</li> </ul> <p>Auto-generated Release Notes:</p> <p>The release log is automatically populated with all commit messages since the last tag, providing a detailed changelog for the release. By default semantic-release uses Angular Commit Message Conventions.</p>"},{"location":"developer-guide/contributing/pr-guidelines/","title":"Pull Request Guidelines","text":""},{"location":"developer-guide/contributing/pr-guidelines/#pull-request-guidelines","title":"Pull Request Guidelines","text":"<p>When creating a pull request (PR) for this repository, it's important to follow the guidelines for PR titles and PR template to ensure consistency and clarity. Proper PR titles help maintain a clear and understandable project history and facilitate better release notes.</p>"},{"location":"developer-guide/contributing/pr-guidelines/#pr-title-format","title":"PR Title Format","text":"<p>All PR titles must adhere to the conventional commits format. This format helps in automating the release process and generating changelogs. The format is as follows:</p> <pre><code>&lt;type&gt;(&lt;scope&gt;): &lt;description&gt;\n</code></pre> <p>type: The type of change being made. It must be one of the following:</p> <ul> <li><code>feat:</code> A new feature</li> <li><code>fix:</code> A bug fix</li> <li><code>ci:</code> Continuous integration-related changes.</li> <li><code>docs:</code> Documentation only changes</li> <li><code>style:</code> Changes that do not affect the meaning of the code (white -space, formatting, missing semi -colons, etc)</li> <li><code>refactor:</code> A code change that neither fixes a bug nor adds a feature</li> <li><code>revert</code>: Reverts a previous commit.</li> <li><code>perf:</code> A code change that improves performance</li> <li><code>test:</code> Adding missing or correcting existing tests</li> <li><code>chore:</code> Changes to the build process or auxiliary tools and libraries such as documentation generation</li> <li><code>build:</code> Changes that affect the build system or external dependencies.</li> <li><code>BREAKING CHANGE:</code> A change that introduces a breaking API change.</li> </ul> <p>scope: An <code>optional</code> description of the section of the codebase affected by the changes (e.g., api, ui, docs). This is enclosed in parentheses.</p> <p>description: A brief summary of the changes made.</p>"},{"location":"developer-guide/contributing/pr-guidelines/#examples","title":"Examples","text":"<ul> <li>feat(api): add new endpoint for data retrieval</li> <li>fix(ui): correct button alignment on mobile devices</li> <li>docs: update contributing guidelines</li> <li>BREAKING CHANGE: refactor authentication middleware to use new library</li> </ul>"},{"location":"frontend-config-guide/default-list-settings/","title":"Frontend config guide","text":""},{"location":"frontend-config-guide/default-list-settings/#default-list-filter-configuration-pattern-frontend-configuration-guide","title":"Default List &amp; Filter Configuration Pattern - Frontend Configuration Guide","text":""},{"location":"frontend-config-guide/default-list-settings/#overview","title":"Overview","text":"<p>This guide explains how to configure the List &amp; Side-Panel Configuration Pattern used on the frontend. It allows customizing how list-based components (e.g., datasets, proposals) display table columns, side-panel filters, and optional query conditions.</p> <p>The configuration should be defined or mounted at the location specified by the environment variable <code>FRONTEND_CONFIG_FILE</code> (default: <code>src/config/frontend.config.json</code>).</p>"},{"location":"frontend-config-guide/default-list-settings/#configuration-details","title":"Configuration Details","text":""},{"location":"frontend-config-guide/default-list-settings/#columns","title":"Columns","text":"<p>Defines how each field is displayed in the list table.</p> Property Type Description Example / Notes <code>name</code> <code>string</code> Object key whose value will be displayed in the column. <code>\"datasetName\"</code> <code>order</code> <code>number</code> Position of the column in the table. <code>2</code> <code>type</code> <code>string</code> How the value is rendered:\u2022 <code>standard</code> \u2013 plain text (default)\u2022 <code>hoverContent</code> \u2013 shows icon with popup/modal when mouseover (for long text)\u2022 <code>date</code> \u2013 formats ISO date strings; can include a <code>format</code> (e.g. <code>yyyy-MM-dd</code>) <code>\"date\"</code> <code>width</code> <code>number</code> Default width of the column. <code>200</code> <code>format</code> <code>string</code> Optional property used only when <code>type</code> is set to <code>date</code>. Defines how ISO date strings are displayed (e.g. <code>yyyy-MM-dd</code>).  it fallsback to <code>dateFormat</code> or <code>yyyy-MM-dd HH:mm</code> for dataset and <code>yyyy-MM-dd</code> for proposal <code>\"yyyy-MM-dd\"</code> <code>enabled</code> <code>boolean</code> Whether the column is displayed by default. <code>true</code>"},{"location":"frontend-config-guide/default-list-settings/#filters","title":"Filters","text":"<p>Defines which filters appear in the side panel and how they behave.</p> Property Type Description Example / Notes <code>key</code> <code>string</code> Object key used for filtering. <code>\"creationTime\"</code> <code>label</code> <code>string</code> Custom label for the filter. If not provided, it falls back to <code>labelLocalization</code> or <code>key</code>. <code>\"Creation Time\"</code> <code>type</code> <code>string</code> Filter input type:\u2022 <code>text</code> \u2013 deprecated (use search box)\u2022 <code>multiSelect</code> \u2013 dropdown with multiple options; supports <code>checkBoxFilterClickTrigger</code> for auto-apply\u2022 <code>dateRange</code> \u2013 calendar or manual from\u2013to input\u2022 <code>checkbox</code> \u2013 pre-populated list; supports <code>checkBoxFilterClickTrigger</code> for auto-apply <code>\"multiSelect\"</code> <code>description</code> <code>string</code> Tooltip text for the filter. <code>\"Filter by dataset type\"</code> <code>enabled</code> <code>boolean</code> Whether the filter is active by default. <code>true</code>"},{"location":"frontend-config-guide/default-list-settings/#conditions","title":"Conditions","text":"<p>Defines predefined condition filter in the side panel (currently supported only for the dataset table)</p> Property Type Description Example / Notes \u2013 \u2013 Currently supported only for dataset filters. \u2014 <code>lhs</code> <code>string</code> Metadata key to filter on <code>\"outgassing_values_after_1h\"</code> <code>relation</code> <code>string</code> Comparison operator:\u2022 <code>GREATER_THAN</code>\u2022 <code>GREATER_THAN_OR_EQUAL</code>\u2022 <code>LESS_THAN</code>\u2022 <code>LESS_THAN_OR_EQUAL</code>\u2022 <code>EQUAL_TO</code>\u2022 <code>RANGE</code> <code>\"EQUAL_TO\"</code> <code>rhs</code> <code>string</code> Value to compare against <code>\"3.1e4\"</code> <code>unit</code> <code>string</code> Optional unit for the value <code>\"mbar l/s/cm^2\"</code> <code>unitsOptions</code> <code>string[]</code> Optional A list of allowed units for this condition. When provided, the unit dropdown will be restricted to only these options <code>[\"mbar l/s/cm^2\", \"Pa m^3/s/m^2\"]</code>"},{"location":"frontend-config-guide/dynamic-dataset-detail-component/","title":"Dynamic Dataset Detail Component - Frontend Configuration Guide","text":""},{"location":"frontend-config-guide/dynamic-dataset-detail-component/#dynamic-dataset-detail-component-frontend-configuration-guide","title":"Dynamic Dataset Detail Component - Frontend Configuration Guide","text":""},{"location":"frontend-config-guide/dynamic-dataset-detail-component/#overview","title":"Overview","text":"<p>This guide provides details on configuring the Dynamic Dataset Detail Component on the frontend. This component can be customized to display dataset information in various templates and layouts based on your needs. The configuration needs to be provided or mounted in the location specified by the environment variable <code>FRONTEND_CONFIG_FILE</code> (default <code>src/config/frontend.config.json</code>).</p>"},{"location":"frontend-config-guide/dynamic-dataset-detail-component/#configuration-guide","title":"Configuration guide","text":"<p>The <code>datasetDetailComponent</code> field allows you to customize the display of dataset details using 4 template types. Each template type is rendered based on the order property, which determines the display priority. The available template types are listed in the Component Configuration Table.</p> <p>You can define labels directly using the <code>label/source</code> property, or use them as keys for localization. If no localization configuration is provided, the template will fall back to using the <code>label/source</code> as the default value.</p> <p>The <code>enableCustomizedComponent</code> flag enables or disables the dynamic component. If set to false, the default dataset detail component will be used. In the customization field, you can provide configuration for the components, including their types, labels, and other settings.</p> <p>Below you can find the example configuration, but for more advanced customizations, refer to the Component Configuration Table for detailed options on each template type and field configuration.</p> <pre><code>\"datasetDetailComponent\": {\n  \"enableCustomizedComponent\": true,\n  \"customization\": [\n    {\n      \"type\": \"regular\",\n      \"label\": \"General Information\",\n      \"order\": 0,\n      \"row\": 1,\n      \"col\": 4,\n      \"fields\": [\n        {\n            \"element\": \"text\",\n            \"source\": \"datasetName\",\n            \"order\": 0\n        },\n        {\n            \"element\": \"copy\",\n            \"source\": \"pid\",\n            \"order\": 1\n        },\n        {\n            \"element\": \"internalLink\",\n            \"source\": \"proposalIds\",\n            \"order\": 2\n        },\n        {\n            \"element\": \"text\",\n            \"source\": \"description\",\n            \"order\": 3\n        }\n        {\n            \"element\": \"text\",\n            \"source\": \"scientificMetadata.start_time.value\",\n            \"order\": 4\n        },\n      ]\n    },\n    {\n      \"type\": \"attachments\",\n      \"label\": \"Scientific Metadata\",\n      \"order\": 1,\n      \"row\": 1,\n      \"col\": 6,\n      \"options\": { \"limit\": 10, \"size\": \"large\" }\n    },\n    {\n      \"type\": \"scientificMetadata\",\n      \"label\": \"Scientific Metadata\",\n      \"viewMode\": \"table\",\n      \"order\": 2,\n      \"row\": 1,\n      \"col\": 10,\n    },\n    {\n      \"type\": \"datasetJsonView\",\n      \"label\": \"Metadata JSON view\",\n      \"order\": 3,\n      \"row\": 1,\n      \"col\": 10,\n    }\n  ]\n}\n</code></pre>"},{"location":"frontend-config-guide/dynamic-dataset-detail-component/#component-configuration-table","title":"Component Configuration Table","text":"Template Type Configurable Fields Field Description Configurable Options Example regular label Title for the section that can be customized. - <code>label</code>: Custom label for the section (e.g., \"General Information\") <code>\"label\": \"General Information\"</code> order Controls the display order of the Regular section in the UI - <code>order</code>: Integer, determines position in the UI <code>\"order\": 0</code> fields List of fields to display within the section. It should contain an array of objects, each with <code>element</code>, <code>source</code>, and <code>order</code> fields. <code>{\"fields\": [{\"element\": \"text\", \"source\": \"datasetName\", \"order\": 0}]}</code> - element Defines the type of data to display in the row (e.g., text, copy, tag, linky, date, internalLink). - <code>element</code>: Field type (e.g., <code>text</code>, <code>copy</code>, <code>tag</code>, <code>linky</code>, <code>date</code>, <code>internalLink</code>) <code>\"element\": \"text\"</code> - source Specifies the dataset property to display, and it must match a field in the <code>OutputDatasetDto</code>, or to be instrumentName . - <code>source</code>: Dataset property name <code>\"source\": \"datasetName\"</code> - order Controls the display order of the field in the fields. - <code>order</code>: Integer, defines the sequence of fields in the UI. Lower values appear first. <code>\"order\": 1</code> attachments label Custom label for the section that can be configured. - <code>label</code>: Custom title for the attachments section (e.g., \"Gallery\") <code>\"label\": \"Scientific Metadata\"</code> order Controls the display order of the attachments section in the UI. - <code>order</code>: Integer, determines sequence within the template. <code>\"order\": 1</code> options Allows configuration for the display of attachments. <code>{\"options\": {\"limit\": 10, \"size\": \"large\"}}</code> options.limit Limits the number of items to display in the attachment section. - <code>limit</code>: Number of items to display (e.g., 10). <code>\"limit\": 10</code> options.size Configures the display size of attachments (small, medium, or large). - <code>size</code>: Display size (small, medium, large). <code>\"size\": \"small\"</code> scientificMetadata label Customizable label for the scientific metadata section. - <code>label</code>: Custom section title (e.g., \"Scientific Metadata\") <code>\"label\": \"Scientific Metadata\"</code> viewMode Defines how the scientific metadata is rendered (as a table, JSON, or tree view). - <code>viewMode</code>: <code>table</code>, <code>json</code>, or <code>tree</code> <code>\"viewMode\": \"table\"</code> order Controls the display order of the scientific metadata section. - <code>order</code>: Integer, determines position in the UI <code>\"order\": 2</code> source Optional field to specify a path to nested scientificMetadata sub-objects. When provided, displays only the specified nested object instead of the entire scientificMetadata. - <code>source</code>: Path to nested metadata (e.g., \"scientificMetadata.instrumentProperties.value\") <code>\"source\": \"scientificMetadata.instrumentProperties.value\"</code> datasetJsonView label Label for the JSON view section. - <code>label</code>: Custom section title (e.g., \"Metadata JSON view\") <code>\"label\": \"Metadata JSON view\"</code> order Controls the display order of the dataset JSON view. - <code>order</code>: Integer, determines position in the UI <code>\"order\": 3</code>"},{"location":"frontend-config-guide/dynamic-dataset-detail-component/#template-types-example-preview","title":"Template Types Example Preview","text":"<ul> <li> <p>regular: Displays dataset properties in configurable rows.   Can be customized with different elements.</p> </li> <li> <p>text: Displays a simple string</p> <p></p> </li> <li> <p>linky: Automatically transforms URLs or emails into clickable links.</p> <p></p> </li> <li> <p>copy: Displays a copy-to-clipboard button</p> <p></p> </li> <li> <p>date: Displays a formatted date based on the dateFormat value in the frontend config file</p> <p></p> </li> <li> <p>tag: Displays a list of items as tags</p> <p></p> </li> <li> <p>internalLink: Converts the value into a clickable link for internal navigation. Supported fields: <code>instrumentIds</code>, <code>proposalIds</code>, <code>sampleIds</code>, and <code>inputDatasets</code>.</p> <p></p> </li> <li> <p>scientificMetadata: Displays metadata in different views:</p> </li> <li> <p>table</p> <p></p> </li> <li> <p>json</p> <p></p> </li> <li> <p>tree</p> <p></p> </li> <li> <p>datasetJsonView: Displays the dataset as a JSON document as addition.</p> </li> <li>attachments: Displays the attachments associated with the dataset. You can configure options like display size and limit the number of items.</li> </ul>"}]}